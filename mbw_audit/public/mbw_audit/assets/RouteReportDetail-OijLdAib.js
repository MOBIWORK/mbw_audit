import{r as s,u as N,A as x,j as e,H as b,F as g,I as O,S as k,a as p,T as H,D as F,b as B}from"./main--zpZemKR.js";import{p as P}from"./path-AHvYoJqN.js";const{RangePicker:q}=F,A=[{title:"STT",dataIndex:"stt"},{title:"Khách hàng",dataIndex:"retail_code"},{title:"Tên chiến dịch",dataIndex:"campaign_name"},{title:"Nhân viên thực hiện",dataIndex:"employee_name"},{title:"Số lượng danh mục sản phẩm",dataIndex:"quantity_cate"},{title:"Thời gian thực hiện",dataIndex:"images_time"},{title:"Hình ảnh",dataIndex:"images",render:i=>e.jsx("img",{src:`${i}`,alt:"image.png",style:{width:"80px",height:"80px",borderRadius:"5px"}})}],J=P.apiUrl;function L(){const[i,y]=s.useState(""),[r,f]=s.useState(null),[c,S]=s.useState("all"),[j,h]=s.useState([]),w=N(),[u,D]=s.useState([]),[_,v]=s.useState([]);s.useState([]),s.useState("checkbox");const E=t=>{localStorage.setItem("recordData",JSON.stringify(t)),w("/report-view")};s.useEffect(()=>{C()},[]);const C=async()=>{let t=await I();try{let a=J+".api.get_list_reports";const n=await x.get(a);if(n&&n.message&&n.message.data){let l=n.message.data.map((o,m)=>{let d=(m+1).toString().padStart(2,"0"),T=JSON.parse(o.categories).length.toString().padStart(2,"0");return{...o,key:o.name,stt:d,quantity_cate:T,employee_name:R(t,o.employee_code)}});D(l),h(l)}}catch(a){console.error("Error fetching report data:",a)}},I=async()=>{try{const a=await x.get("/api/method/mbw_service_v2.api.ess.employee.get_list_employee");if(a&&a.result&&a.result.data)return v(a.result.data),a.result.data}catch(t){console.error("Error fetching employee data:",t)}},R=(t,a)=>{const n=t.find(l=>l.name===a);return n?n.employee_name:""};return s.useEffect(()=>{const t=u.filter(a=>{const n=a.campaign_name.toLowerCase().includes(i.toLowerCase()),l=r&&r[0]?new Date(r[0]):null,o=r&&r[1]?new Date(r[1]):null,m=l&&o?new Date(a.images_time)>=new Date(l.setHours(0,0,0,0))&&new Date(a.images_time)<=new Date(o.setHours(23,59,59,999)):!0,d=c==="all"||a.employee_code===c;return n&&d&&m});h(t)},[i,r,c,u]),e.jsxs(e.Fragment,{children:[e.jsx(b,{title:"Báo cáo"}),e.jsxs("div",{className:"bg-white rounded-xl",children:[e.jsxs("div",{className:"flex p-4",style:{alignItems:"flex-end"},children:[e.jsx(g,{className:"w-[320px] border-none mr-4 ",children:e.jsx(O,{placeholder:"Tìm kiếm theo chiến dịch",value:i,onChange:t=>y(t.target.value),prefix:e.jsx(k,{})})}),e.jsx(g,{className:"w-[250px] border-none mr-4",label:"Thời gian thực hiện",children:e.jsx(q,{value:r,onChange:t=>f(t)})}),e.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[e.jsx("label",{style:{paddingBottom:"5px"},children:"Nhân viên:"}),e.jsxs(p,{className:"w-[200px] h-[36px]",value:c,onChange:t=>S(t),defaultValue:"all",children:[e.jsx(p.Option,{value:"all",children:"Tất cả"}),_.map(t=>e.jsx(p.Option,{value:t.name,children:t.employee_name},t.name))]})]})]}),e.jsx("div",{children:e.jsx(H,{columns:A,dataSource:j,onRow:(t,a)=>({onClick:()=>E(t)}),rowHoverBg:"#f0f0f0"})})]})]})}function V(){return e.jsxs(e.Fragment,{children:[e.jsx(B,{children:e.jsx("title",{children:"BÁO CÁO"})}),e.jsx(L,{})]})}export{V as default};
